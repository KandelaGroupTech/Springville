<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Casa Springville Welcome</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link
    href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;1,400;1,700&family=Inter:wght@300;400;500;600&display=swap"
    rel="stylesheet">
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            serif: ['"Playfair Display"', 'serif'],
            sans: ['Inter', 'sans-serif'],
          },
          colors: {
            'casa-gold': '#D4AF37',
            'casa-dark': '#0F172A',
          }
        }
      }
    }
  </script>
  <style>
    body {
      background: linear-gradient(135deg, #000000 0%, #006464 100%);
      color: #e2e8f0;
    }

    /* Hide scrollbar for Chrome, Safari and Opera */
    .scrollbar-hide::-webkit-scrollbar {
      display: none;
    }

    /* Hide scrollbar for IE, Edge and Firefox */
    .scrollbar-hide {
      -ms-overflow-style: none;
      /* IE and Edge */
      scrollbar-width: none;
      /* Firefox */
    }
  </style>
</head>

<body
  class="h-screen w-screen overflow-hidden flex flex-col items-center justify-center font-sans relative p-6 md:p-10">

  <!-- Date and Time (Fixed Top LEFT to avoid overlap) -->
  <div class="fixed top-8 left-10 text-left z-50 pointer-events-none">
    <div id="current-time" class="text-4xl md:text-5xl font-serif text-white font-bold tracking-wider drop-shadow-lg">
      --:--</div>
    <div id="current-date" class="text-casa-gold text-xs uppercase tracking-[0.2em] mt-1 font-medium drop-shadow-md">--
      --, ----
    </div>
  </div>

  <!-- Loading State -->
  <div id="loading"
    class="text-casa-gold text-xl animate-pulse absolute inset-0 flex items-center justify-center bg-black/80 z-50">
    Loading guest experience...</div>

  <!-- Dashboard Container -->
  <div id="dashboard" class="hidden w-full max-w-[1600px] h-full grid grid-rows-[55%_45%] gap-8">

    <!-- TOP ROW: Info Grid -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-8 min-h-0">

      <!-- Col 1: Welcome & Concierge -->
      <div class="flex flex-col gap-6 h-full min-h-0 pt-16">
        <!-- Header (Strictly Right Aligned) -->
        <div class="space-y-1 flex-shrink-0 text-right w-full flex flex-col items-end">
          <h2 class="text-casa-gold tracking-widest uppercase text-[10px] font-semibold">Guest Access</h2>
          <h1 class="text-4xl md:text-6xl font-serif text-white leading-tight">
            Welcome, <br><span id="guest-name" class="text-casa-gold italic">Guest</span>.
          </h1>
        </div>

        <!-- Concierge Note (Compact) -->
        <div
          class="bg-white/5 backdrop-blur-md border border-white/10 p-6 rounded-2xl flex-grow flex flex-col justify-center shadow-lg relative overflow-hidden group min-h-0">
          <div
            class="absolute inset-0 bg-gradient-to-b from-transparent to-black/20 opacity-0 group-hover:opacity-100 transition-opacity">
          </div>
          <div class="overflow-y-auto scrollbar-hide relative z-10 flex items-center justify-center h-full">
            <p id="concierge-note"
              class="text-lg md:text-xl font-serif italic leading-relaxed text-gray-100 text-center">
              "Welcome to Casa Springville."
            </p>
          </div>
          <div
            class="mt-4 flex flex-shrink-0 items-center justify-center space-x-2 text-[10px] text-gray-400 uppercase tracking-wider relative z-10">
            <span class="w-6 h-px bg-casa-gold"></span>
            <span>Concierge</span>
            <span class="w-6 h-px bg-casa-gold"></span>
          </div>
        </div>
      </div>

      <!-- Col 2: House Rules -->
      <div class="bg-white/5 backdrop-blur-md border border-white/10 p-6 rounded-2xl h-full flex flex-col min-h-0">
        <h3
          class="text-casa-gold text-xs uppercase tracking-wider font-semibold mb-4 flex items-center gap-2 flex-shrink-0">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
          </svg>
          House Rules
        </h3>
        <ul class="space-y-4 text-gray-300 font-light text-sm overflow-y-auto pr-2 scrollbar-hide">
          <li class="flex gap-3">
            <span class="text-casa-gold font-mono text-xs pt-1">01</span>
            <span><strong class="text-white font-medium">Quiet Hours:</strong> Please observe quiet time from 9:00 PM
              onwards.</span>
          </li>
          <li class="flex gap-3">
            <span class="text-casa-gold font-mono text-xs pt-1">02</span>
            <span><strong class="text-white font-medium">Kitchen:</strong> Please refill the water jug in the
              refrigerator if you finish it.</span>
          </li>
          <li class="flex gap-3">
            <span class="text-casa-gold font-mono text-xs pt-1">03</span>
            <span><strong class="text-white font-medium">Smoking:</strong> No smoking is permitted inside.</span>
          </li>
          <li class="flex gap-3">
            <span class="text-casa-gold font-mono text-xs pt-1">04</span>
            <span><strong class="text-white font-medium">Enjoy:</strong> Please feel at home!</span>
          </li>
          <li class="flex gap-3">
            <span class="text-casa-gold font-mono text-xs pt-1">05</span>
            <span><strong class="text-white font-medium">Safety:</strong> Lock doors when leaving.</span>
          </li>
        </ul>
      </div>

      <!-- Col 3: Details & Numbers (Compact/Refined) -->
      <div class="flex flex-col gap-4 h-full min-h-0">
        <!-- Dates -->
        <div class="grid grid-cols-2 gap-4 flex-shrink-0">
          <div class="bg-white/5 p-3 rounded-xl border border-white/10 text-center">
            <div class="text-casa-gold text-[10px] uppercase tracking-wider mb-1">Check-in</div>
            <div id="check-in" class="text-lg font-serif text-white">--</div>
          </div>
          <div class="bg-white/5 p-3 rounded-xl border border-white/10 text-center">
            <div class="text-casa-gold text-[10px] uppercase tracking-wider mb-1">Check-out</div>
            <div id="check-out" class="text-lg font-serif text-white">--</div>
          </div>
        </div>

        <!-- Helpful Numbers (COMPACTED) -->
        <div class="bg-white/5 backdrop-blur-md border border-white/10 p-4 rounded-2xl flex-shrink-0 text-left">
          <div class="flex items-center justify-between mb-2">
            <h3 class="text-casa-gold text-xs uppercase tracking-wider font-semibold flex items-center gap-2">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24"
                stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
              </svg>
              Helpful Phone Numbers
            </h3>
          </div>

          <div class="space-y-3">
            <div class="flex items-start justify-between">
              <div>
                <p class="text-gray-400 text-[10px] uppercase tracking-wider mb-0.5">Building Services</p>
                <a href="tel:3019736198"
                  class="text-base text-white font-serif hover:text-casa-gold transition-colors">301-973-6198</a>
              </div>
            </div>

            <div class="pt-2 border-t border-white/5">
              <div class="flex items-start justify-between mb-1">
                <div>
                  <p class="text-gray-400 text-[10px] uppercase tracking-wider mb-0.5">Silver Spring Police</p>
                  <a href="tel:3012798000"
                    class="text-base text-white font-serif hover:text-casa-gold transition-colors">301-279-8000</a>
                </div>
              </div>
              <div class="mt-1">
                <p class="text-white text-[11px] font-semibold">Silver Spring Police Dept</p>
                <p class="text-gray-400 text-[9px]">8045 Newell St ‚Ä¢ 0.3 Miles Away</p>
              </div>
            </div>
          </div>
        </div>

        <!-- WiFi (Reduced Spacing to Fix Clip) -->
        <div
          class="bg-white/5 backdrop-blur-md border border-white/10 p-5 rounded-2xl flex items-center justify-center gap-4 flex-grow min-h-0 relative overflow-hidden">
          <div class="absolute top-0 left-0 w-full h-1 bg-casa-gold/30"></div>

          <!-- QR Code (Left - Reduced size from w-28 to w-24 to match height) -->
          <div class="bg-white/90 p-2 rounded-xl shadow-lg flex-shrink-0">
            <img src="/assets/wifi-qr-code.png" alt="WiFi QR Code" class="w-24 h-24 object-contain">
          </div>

          <!-- Details (Right - Reduced vertical spacing) -->
          <div class="text-left space-y-2 flex flex-col justify-center">
            <!-- Removed border-b and reduced font size SLIGHTLY to xs but uppercase to keep style -->
            <h3 class="text-casa-gold text-xs uppercase tracking-widest font-semibold">Priority WiFi Access</h3>

            <div>
              <p class="text-gray-400 text-[9px] uppercase tracking-wider">Network</p>
              <p class="text-xl md:text-2xl text-white font-serif leading-none select-all group cursor-pointer"
                title="Click to copy">
                Verizon_QZ3ZXJ
              </p>
            </div>

            <div>
              <p class="text-gray-400 text-[9px] uppercase tracking-wider">Password</p>
              <p
                class="text-lg md:text-xl text-white font-mono select-all bg-black/30 px-2 py-1 rounded inline-block border border-white/5 leading-none">
                aid-maid4-zap
              </p>
            </div>
          </div>
        </div>
      </div>

    </div>

    <!-- BOTTOM ROW: Weather (Hero Section) -->
    <div id="weather-section"
      class="bg-white/5 backdrop-blur-md border border-white/10 p-8 rounded-3xl flex flex-col relative overflow-hidden min-h-0 w-full">
      <!-- Background decorative elements -->
      <div
        class="absolute top-0 right-0 p-40 bg-casa-gold/5 rounded-full blur-3xl -translate-y-1/2 translate-x-1/2 pointer-events-none">
      </div>

      <div class="flex items-center justify-between mb-6 flex-shrink-0 relative z-10 w-full">
        <h3 class="text-casa-gold text-sm uppercase tracking-widest font-semibold flex items-center gap-3">
          <span class="text-2xl">üå§Ô∏è</span> Silver Spring Forecast
        </h3>
        <div class="flex gap-2 text-white/20">
          <!-- Decorative dots -->
          <div class="w-2 h-2 rounded-full bg-current"></div>
          <div class="w-2 h-2 rounded-full bg-current"></div>
          <div class="w-2 h-2 rounded-full bg-current"></div>
        </div>
      </div>

      <!-- Weather Cards Container (Full Width, Consistent Sizing) -->
      <div id="weather-scroll"
        class="flex-grow flex items-center justify-between gap-4 overflow-x-auto pb-2 scrollbar-hide relative z-10 w-full">
        <!-- Injected Javascript Cards -->
      </div>
    </div>

  </div>

  <!-- Full Screen Button -->
  <button id="fullscreen-btn"
    class="fixed bottom-6 right-6 text-white/20 hover:text-white/80 transition-all duration-300 z-50 p-3 bg-black/20 rounded-full backdrop-blur-sm border border-white/5"
    title="Toggle Full Screen">
    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"
      class="w-5 h-5">
      <path stroke-linecap="round" stroke-linejoin="round"
        d="M3.75 3.75v4.5m0-4.5h4.5m-4.5 0L9 9M3.75 20.25v-4.5m0 4.5h4.5m-4.5 0L9 15M20.25 3.75h-4.5m4.5 0v4.5m0-4.5L15 9m5.25 11.25h-4.5m4.5 0v-4.5m0 4.5L15 15" />
    </svg>
  </button>

  <script>
    // Guest Data Logic
    fetch('/api/get-guest')
      .then(res => res.json())
      .then(data => {
        const dashboard = document.getElementById('dashboard');
        const loading = document.getElementById('loading');

        loading.classList.add('hidden');
        dashboard.classList.remove('hidden');

        if (data.firstName) document.getElementById('guest-name').innerText = data.firstName; // innerText to support text transform if needed, though class handles it
        if (data.conciergeNote) document.getElementById('concierge-note').textContent = `"${data.conciergeNote}"`;
        if (data.checkIn) document.getElementById('check-in').textContent = new Date(data.checkIn + 'T00:00:00').toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
        if (data.checkOut) document.getElementById('check-out').textContent = new Date(data.checkOut + 'T00:00:00').toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
      })
      .catch(err => {
        console.error("API Error, using fallback:", err);
        const today = new Date();
        const nextWeek = new Date(today);
        nextWeek.setDate(today.getDate() + 7);

        document.getElementById('loading').classList.add('hidden');
        document.getElementById('dashboard').classList.remove('hidden');
        document.getElementById('check-in').textContent = today.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
        document.getElementById('check-out').textContent = nextWeek.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
      });

    // Weather Logic (Horizontal, Big Icons, Text Desc)
    const weatherSection = document.getElementById('weather-section');
    const weatherScroll = document.getElementById('weather-scroll');
    const weatherCodes = {
      0: { icon: '‚òÄÔ∏è', desc: 'Clear' },
      1: { icon: 'üå§Ô∏è', desc: 'Mostly Clear' },
      2: { icon: 'üå•Ô∏è', desc: 'Partly Cloudy' },
      3: { icon: '‚òÅÔ∏è', desc: 'Overcast' },
      45: { icon: 'üå´Ô∏è', desc: 'Fog' },
      48: { icon: 'üå´Ô∏è', desc: 'Icy Fog' },
      51: { icon: 'üå¶Ô∏è', desc: 'Drizzle' },
      53: { icon: 'üå¶Ô∏è', desc: 'Drizzle' },
      55: { icon: 'üå¶Ô∏è', desc: 'Drizzle' },
      61: { icon: 'üåßÔ∏è', desc: 'Rain' },
      63: { icon: 'üåßÔ∏è', desc: 'Rain' },
      65: { icon: 'üåßÔ∏è', desc: 'Heavy Rain' },
      71: { icon: '‚ùÑÔ∏è', desc: 'Snow' },
      73: { icon: '‚ùÑÔ∏è', desc: 'Snow' },
      75: { icon: '‚ùÑÔ∏è', desc: 'Heavy Snow' },
      95: { icon: '‚õàÔ∏è', desc: 'Thunder' }
    };

    function getWeatherInfo(code) {
      return weatherCodes[code] || { icon: '‚õÖ', desc: 'Cloudy' };
    }

    fetch('https://api.open-meteo.com/v1/forecast?latitude=38.9907&longitude=-77.0261&daily=weather_code,temperature_2m_max,temperature_2m_min&temperature_unit=fahrenheit&timezone=America%2FNew_York&forecast_days=8')
      .then(res => res.json())
      .then(data => {
        if (!data.daily) return;

        weatherScroll.innerHTML = '';

        // Render rows
        data.daily.time.forEach((time, index) => {
          const date = new Date(time + 'T00:00:00');
          const dayName = date.toLocaleDateString('en-US', { weekday: 'short' });
          const maxTemp = Math.round(data.daily.temperature_2m_max[index]);
          const minTemp = Math.round(data.daily.temperature_2m_min[index]);
          const code = data.daily.weather_code[index];
          const info = getWeatherInfo(code);

          // Hero Sizing
          const card = document.createElement('div');
          card.className = "flex-1 min-w-[100px] h-full flex flex-col items-center justify-center p-3 rounded-2xl bg-white/5 hover:bg-white/10 transition-all duration-300 border border-white/5 hover:border-white/20 hover:-translate-y-1 cursor-default group";

          card.innerHTML = `
              <span class="text-xs md:text-sm text-casa-gold uppercase font-bold tracking-widest mb-2">${dayName}</span>
              <span class="text-4xl md:text-5xl mb-2 group-hover:scale-110 transition-transform filter drop-shadow-lg">${info.icon}</span>
              <span class="text-[10px] text-gray-300 uppercase tracking-wider mb-2 font-medium">${info.desc}</span>
              <div class="flex items-center gap-2">
                  <span class="text-lg md:text-xl font-bold text-white">${maxTemp}¬∞</span>
                  <span class="text-sm text-gray-500 font-medium">${minTemp}¬∞</span>
              </div>
          `;
          weatherScroll.appendChild(card);
        });
      })
      .catch(console.error);

    // DateTime
    function updateDateTime() {
      const now = new Date();
      document.getElementById('current-time').textContent = now.toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit', hour12: true });
      document.getElementById('current-date').textContent = now.toLocaleDateString('en-US', { weekday: 'long', month: 'long', day: 'numeric' });
    }
    setInterval(updateDateTime, 1000);
    updateDateTime();

    // Fullscreen
    document.getElementById('fullscreen-btn').addEventListener('click', () => {
      if (!document.fullscreenElement) document.documentElement.requestFullscreen().catch(console.error);
      else if (document.exitFullscreen) document.exitFullscreen();
    });
  </script>
</body>

</html>